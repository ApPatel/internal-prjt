<%= form_for(@event) do |f| %>
  <% if @event.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@event.errors.count, "error") %> prohibited this event from being saved:</h2>

      <ul>
      <% @event.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
<div class="wrapper">
  <div class="field">
    <%= f.label :'Event name' %><br />
    <%= f.text_field :name %>
  </div>
  <div class="field">
    <%= f.label :'Event agenda' %><br />
    <%= f.text_field :agenda %>
  </div>
  <div class="field">
    <%= f.label :description %><br />
    <%= f.text_area :description %>
  </div>
 <div class="field">
     <%= f.label :'event date' %><br />
 <%= date_select('event','event_date')%>
</div>


  <div class="field">
    <%= f.label :'attachment file' %><br />
   <%= f.file_field :attachment_file %>
  </div>
  
  <div class="field" id ="sc">
    <%= f.label :'sub category' %><br />
    <%@sub_categories=SubCategory.all%>

 <%=  f.select :sub_category_id, options_for_select(@sub_categories.collect {|sub_category| [sub_category.name , sub_category.id]}), {:include_blank => 'Please Select'}%>
  </div>
   <%= link_to "Create New Sub Category for this Event", events_other_sub_category_path ,:id => 'subNewCat'%>
   <div id="other"></div>

  
  <div class="actions">
    <%= f.submit %>
  </div>
</div>
<% end %>

<script type="text/javascript">

  $(document).ready(function(){

     $('#subNewCat').click(function(){   

  
  if($('#event_sub_category_id').val()) 
    {
       alert("Sub Category is already selected") 
    } 
    else
    {
    $.ajax({
    url: '/events/other_sub_category',
    error: function (XMLHttpRequest, textStatus, errorThrown) {
      alert("Something went wrong!! Please try again later.");
                
    },
    success: function(data){    
    jQuery("#other").html(data);
    },
    type: "get"
  });  
  }      
        return false;
     });
   

  });
</script>